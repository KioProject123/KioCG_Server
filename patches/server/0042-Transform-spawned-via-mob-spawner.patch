From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Joket_abc <15005771700@qq.com>
Date: Wed, 5 Jun 2024 16:03:11 +0800
Subject: [PATCH] Transform spawned via mob spawner


diff --git a/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java b/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
index 5ed949083cd1e01b3d97713de0937fbee8ab4c3d..7acbe513ec7e0e8a35e13ec23d99d013ebcc6675 100644
--- a/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
+++ b/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
@@ -610,6 +610,7 @@ public class CraftEventFactory {
         List<org.bukkit.entity.Entity> list = new ArrayList<>();
         for (net.minecraft.world.entity.LivingEntity entityLiving : convertedList) {
             entityLiving.transformScaleSimulate(original); // KioCG
+            entityLiving.spawnedViaMobSpawner = original.spawnedViaMobSpawner; // KioCG
             list.add(entityLiving.getBukkitEntity());
         }
 
@@ -1339,6 +1340,7 @@ public class CraftEventFactory {
 
     public static PigZapEvent callPigZapEvent(Entity pig, Entity lightning, Entity pigzombie) {
         ((net.minecraft.world.entity.LivingEntity) pigzombie).transformScaleSimulate((net.minecraft.world.entity.LivingEntity) pig); // KioCG
+        pigzombie.spawnedViaMobSpawner = pig.spawnedViaMobSpawner; // KioCG
         PigZapEvent event = new PigZapEvent((Pig) pig.getBukkitEntity(), (LightningStrike) lightning.getBukkitEntity(), (PigZombie) pigzombie.getBukkitEntity());
         pig.getBukkitEntity().getServer().getPluginManager().callEvent(event);
         return event;
@@ -1352,6 +1354,7 @@ public class CraftEventFactory {
 
     // Paper start
     public static com.destroystokyo.paper.event.entity.EntityZapEvent callEntityZapEvent(Entity entity, Entity lightning, Entity changedEntity) {
+        changedEntity.spawnedViaMobSpawner = entity.spawnedViaMobSpawner; // KioCG
         com.destroystokyo.paper.event.entity.EntityZapEvent event = new com.destroystokyo.paper.event.entity.EntityZapEvent(entity.getBukkitEntity(), (LightningStrike) lightning.getBukkitEntity(), changedEntity.getBukkitEntity());
         entity.getBukkitEntity().getServer().getPluginManager().callEvent(event);
         return event;
