From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Joket_abc <15005771700@qq.com>
Date: Sun, 17 Mar 2024 13:55:25 +0800
Subject: [PATCH] Saplings withered


diff --git a/src/main/java/io/papermc/paper/configuration/WorldConfiguration.java b/src/main/java/io/papermc/paper/configuration/WorldConfiguration.java
index a2d9de443667c22f43044a16cf68d42dcd775d41..cd74843fa86a27e919df35eed57cea3e277c7124 100644
--- a/src/main/java/io/papermc/paper/configuration/WorldConfiguration.java
+++ b/src/main/java/io/papermc/paper/configuration/WorldConfiguration.java
@@ -590,6 +590,7 @@ public class WorldConfiguration extends ConfigurationPart {
 
         public boolean betterMobGriefingSetting = true;
         public double dirtPathSpeedBoost = 0.04;
+        public double saplingsWitheredChance = 0.025;
     }
     // KioCG end
 }
diff --git a/src/main/java/net/minecraft/world/level/block/SaplingBlock.java b/src/main/java/net/minecraft/world/level/block/SaplingBlock.java
index 3ff0d08e4964aae82d8e51d3b8bf9aa002096f81..53666ce348a07ca59d6aef416ddda623dc453dfb 100644
--- a/src/main/java/net/minecraft/world/level/block/SaplingBlock.java
+++ b/src/main/java/net/minecraft/world/level/block/SaplingBlock.java
@@ -55,7 +55,15 @@ public class SaplingBlock extends BushBlock implements BonemealableBlock {
 
     @Override
     public void randomTick(net.minecraft.world.level.block.state.BlockState state, ServerLevel world, BlockPos pos, RandomSource random) {
-        if (world.getMaxLocalRawBrightness(pos.above()) >= 9 && random.nextFloat() < (world.spigotConfig.saplingModifier / (100.0f * 7))) { // Spigot - SPIGOT-7159: Better modifier resolution
+        // KioCG start
+        if (random.nextFloat() < (world.spigotConfig.saplingModifier / (100.0f * 7))) { // Spigot - SPIGOT-7159: Better modifier resolution
+            if (random.nextDouble() < world.paperConfig().kiocgConfig.saplingsWitheredChance) {
+                world.setBlock(pos, Blocks.DEAD_BUSH.defaultBlockState(), 3);
+                return;
+            }
+
+            if (world.getMaxLocalRawBrightness(pos.above()) >= 9)
+        // KioCG end
             this.advanceTree(world, pos, state, random);
         }
 
